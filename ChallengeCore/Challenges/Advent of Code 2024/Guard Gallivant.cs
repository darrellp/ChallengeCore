#define SAMPLE

using System;
using System.Collections.Generic;
using System.Linq;
using static System.Console;

// ReSharper disable IdentifierTypo
// ReSharper disable StringLiteralTypo

// ReSharper disable once CheckNamespace
namespace ChallengeCore.Challenges
{
    public static partial class ChallengeClass
    {
        [Challenge("Advent of Code 2024", "Guard Gallivant (6)", "https://adventofcode.com/2024/day/6")]
        // ReSharper disable once UnusedMember.Global
        public class GuardGalivant : IChallenge
        {
            private static readonly (int, int)[] _dirs = new[]
            {
                (-1, 0),    // North
                (0, 1),     // East
                (1, 0),     // South
                (0, -1)     // West
            };
            private List<string> _lines;
            private (int, int) _glCur;
            private int _dirCur = -1;
            private int _height;
            private int _width;

            public void Solve()
            {
                // Get data
                _lines = GetLines();
                _height = _lines.Count;
                _width = _lines[0].Length;
                for (var iRow = 0; iRow < _lines.Count; iRow++)
                {
                    for (var iCol = 0; iCol < _lines[0].Length; iCol++)
                    {
                        var ch = _lines[iRow][iCol];
                        if (ch != '.' && ch != '#')
                        {
                            _glCur = (iRow, iCol);
                            _dirCur = ch switch
                            {
                                '^' => 0,
                                '>' => 1,
                                'v' => 2,
                                '<' => 3,
                                _ => throw new InvalidOperationException("Bad character in map")
                            };
                            break;
                        }
                    }

                    if (_dirCur >= 0)
                    {
                        break;
                    }
                }

                // Part 1
                var marks = new int[_height][];
                for (int iRow = 0; iRow < _height; iRow++)
                {
                    marks[iRow] = new int[_width];
                }

                marks[_glCur.Item1][_glCur.Item2] = 1;
                while (Advance())
                {
                    marks[_glCur.Item1][_glCur.Item2] = 1;
                }

                WriteLine(marks.Select(r => r.Sum()).Sum());

                // Part 2
                WriteLine(0);
            }

            private bool Advance()
            {
                var dir = _dirs[_dirCur];
                var next = (_glCur.Item1 + dir.Item1, _glCur.Item2 + dir.Item2);
                if (next.Item1 < 0 || next.Item1 >= _width || next.Item2 < 0 || next.Item2 >= _height)
                {
                    return false;
                }

                while (_lines[next.Item1][next.Item2] == '#')
                {
                    _dirCur = (_dirCur + 1) % 4;
                    dir = _dirs[_dirCur];
                    next = (_glCur.Item1 + dir.Item1, _glCur.Item2 + dir.Item2);
                }

                _glCur = next;
                return true;
            }

#if SAMPLE
            public string RetrieveSampleInput()
            {
                return @"
....#.....
.........#
..........
..#.......
.......#..
..........
.#..^.....
........#.
#.........
......#...
";
            }

            public string RetrieveSampleOutput()
            {
                return @"
41
0
";
            }
#else
            public string RetrieveSampleInput()
            {
                return @"
//...#........................................#........#.................#............#.#.......................#...............#..#
//...#........#.....#..................................................................................#......#..#..................
//.................#.......................#.#........#......#...........................................#...#..........#...........
//..................#..................#...#.....................................#........#.........................................
//...#.....#.......#..............#.#....##.............#....##......................................#...................#..........
//...#..........................................................................................................................#...
//..#..#.............#.....#...............#.......#..............................................#....#............................
//......................#..#...............#...................#....#..........................#...#............#...#....##.........
//..#.#.........#................#............#............#.#.......#................#....#..#.....................................
//.......................................................................#.....................................#...........#........
//...........#.....................................................................#.................................#......#.......
//...#.........#....................................................#..............#.............#..........#.......................
//.................................................................................................#................................
//..................................#.#.#...#.......#.............#.......................#..#.......................#.#............
//.......................#.........................................#..........#...#.....#....................................#......
//.......#.......#.#...........#......................#.....#..#...#.#...............#.............................#...#............
//............##...#......#.........#......#............................................................#.........#..............#..
//..#........................................#........##..#...............................................................#.........
//...........#..............##................................................................................#.....................
//..#................................................................................#..............#...............................
//...................................##..............#..........................#.......#..#...............#........#...............
//....#............#.........................#................................................................#........#............
//............#.....................................................................#.............................................#.
//............#..........#.......#...........#.#......#..............#.........#.......................................#......#.....
//..#...............................................#..................................#.............................#.............#
//.........................................................................#........#................#......#.......#....#........#.
//.......................................................................#.....##.................................................#.
//..............#.............#...........................#...#..#....................................................#.............
//.......#..........................#.......................###..................................#.....................#..#.........
//................#.................#.............#......................................................................#........#.
//.#.....#................#......................................................................#................#.................
//................................#........................#........#..#........................#...................................
//..............................................................................................#.....................#.........#...
//..................#.................#.........................#.....#................#............................................
//......#...................#...#...................#..................#...........................#......###...................#...
//.............................##.....#..............#..............................................................#....#..........
//......#..................#....................................................###....................#..............#.............
//............#...#..................#........#.............#..............................#.........#..........................#...
//....#...............................#......#......#...............#.#......#............#...................................#.....
//.......#...................................#.#.#.........................................................#..................#.....
//.....................#.......#.#......#.#.....................#...................................................................
//......#.....#............................................................................#............#.......#..#................
//..........#.#......#...................................#....#.#............##.....................................................
//...............#........................#..................................#...........#...................................#......
//.#....................................................#.......................................................................#...
//......#.........................................#...#.........................................#........#..........................
//.........................................#..........#.............................................................................
//...................#.....................................#.....................#..#............#....#........................##...
//.................................#.........#.............#.............................#...........................#...#..........
//..#................................................................#.....#....#.................................#.................
//........#................#............#.#..........................................#..............................................
//..#...........##.....................#..#..........................#...#...#....#.................................................
//................................................................................#.................................................
//............#...........#.........#....#.........................................................................#................
//.............................#...........................................#...............##...................................#...
//......................#..............#...#........................#........................................#......................
//............#..............#...#.....#.....#..........#...........................#........#...............#......................
//..................#............................#....#................................................................#............
//..#........................#.............................#......#...............#....#...........#................................
//.................................................#................................................#..................#........#...
//.#......#.........................................................#...........#...#.......................#.......................
//..........................................#.......##........#................................................#..##............##..
//..............#...#....................................................................#........#...........................#.....
//................#....................................................................#........................................###.
//....#............................................#........................#.................#........#.....#...#.....#.#....#.....
//...##..........#..................................................................................................................
//#....#.........#....................#.#.........................#..........##.......#....#..#....................#................
//........#.........#..........#.................#..................#................................#.......#................#...#.
//.#..........................................#..#..#......#................................#.#.#..#................................
//....#.......#.........#............................................................#....#.........................................
//.....................................................................#...#......................#.................................
//............#.....#.....#..........#...............................................................................#..............
//.........................#...#.#.......#....................................................................#.................#...
//......................................................#.#..........................#...#................#.........................
//.....#.........#.........#..............................................................#...................#.#......#............
//.......................................#......#.......................#.................................................#.....#...
//.....#....#.......................................................................................................................
//#..........#....#....................................#.............#...............#...................#..........#...............
//..#....................................##.....................................#...............................#...................
//....#..................................#........................#.................................................................
//....#................................................................................................#...................#........
//....#................................................................................#............................................
//..........#.....#...................#.......................#......#..............................................................
//#...................#..........#............................................................#............#..............#.........
//...#...#....#................................#............................#.##.....................................#..............
//..........#.........#.....#...........#............................#...............#.#....#................#....................##
//.....#...................................................#........................................................................
//............##....................................#..................#.#..#.....................#.........#....##......#...#......
//...........#.......#....................#.......................#..#.................#.......#.........#..........................
//#.....................#..#..............................................................................................#.........
//....#....#..............#............##....................................................^.................#..............#.....
//.........#......................................................#..............#............#...#......#....#.....................
//.......##...................#...........#.........#.......................................#..........................#............
//.#........#.#........................#...........#............#..#........#........#.............#................................
//..................##........##.................................................................................#................#.
//...#...................#.....#...........#.........#..#............#..................................#.....#.....................
//.................#.........#..........#............#......#.........................#.............#.......#......................#
//.................................................................#...............#.....#.#....#...................................
//..........................#...........................................................................................#..#........
//..............#.................................................................................##......................#.........
//....#...#....................#...............................................#................#............#......................
//........................................................................#........#................................................
//....#.....#......................#.......#............#......................................#..................................#.
//................#................................#.#.............#.#.........#..............................................#.....
//..............#..................#...#...........................................................................#................
//...#..........#....................................................#...............................#...........#.......#..........
//...................................#....................#..#.#........#..#.......................#...#.....#......................
//.......#.....#.#.......#....#............#...............#..........#.................#........#.#................................
//.....#....#.........#........#.......#............................................................................................
//..#........#......#............................................................#..........#...............................#.......
//..#..#...................................#....................#...#.#................#......................#.....................
//....................................#......#.....................#...........#.....................#........#.....................
//.#..................#.........................................................................................................#...
//..............#...........#.#....#..#......#..#.#...#.#.........................................................................#.
//...#............##.......................................................#.......................#..#.............................
//......#........#..........#..#.#........#.....................#...................................................................
//...#...........#.........................................#............#.............#....#.....................................#..
//...........#.....................#......................................................................................#.........
//.......#..............#...............#............#..........................#............................#........##............
//.............#..........#..............................................#................#..............................#..........
//...............#..............................#.................#.....#................#....#.....................................
//............#.................#..........#........#............#..#......#.......................#....#...#.#...#.#...............
//.......#.#...................................##..............#.....#.....................#.................................##.....
//..#..#...#...#....#.............#..#.....................................................................................#........
//......#......................#...#...#..........#......................................#.................#....#.................#.
//.......#...........#...........#...................#..............................#.......................................#.......
//......#.......................................#...............................................#.........#........#....#.........##
//......#.................................................................#...#............#..........#.............................
//.....................................#..........#.........#.....#.............#...........#.......................................
//.#.....................................#......................#.....#..#..........................................................";
            }

            public string RetrieveSampleOutput()
            {
                return @"
5516
0
";
            }
#endif
        }
    }
}

